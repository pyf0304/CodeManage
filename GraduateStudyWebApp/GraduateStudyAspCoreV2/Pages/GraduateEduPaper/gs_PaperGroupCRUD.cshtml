@page
@{
Layout = "~/Pages/Shared/_Layout_Empty.cshtml";
ViewData["Title"] = "论文分组维护";
}
@section Styles{
<link rel="stylesheet" href="../lib/bootstrap/dist/css/bootstrap.css" />
<link rel="stylesheet" href="../css/site.css" />
<link rel="shortcut icon" href="~/images/favicon.ico" type="image/x-icon" />
}
@section Scripts{
<script src="~/lib/xlsx.core.min.js" type="text/javascript"></script>
<script src="~/lib/xlsx.full.min.js" type="text/javascript"></script>
<script src="../lib/require/require.js" data-main="../js/src/config"></script>
}
<script>
    //所有用户自定义的JS函数建议都放在这里


</script>
<script>

    /**
     按钮单击,用于调用Js函数中btn_Click
    (AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_btn_Click)
    **/
    function btn_Click(strCommandName, strKeyId) {
        require(["../js/GraduateEduPaper/gs_PaperGroupCRUDEx.js"], function (gs_papergroup) {
            gs_papergroup.gs_PaperGroupCRUDEx.btn_Click(strCommandName, strKeyId);
        });
    }

    /**
     页面导入-在导入页面后运行的函数
    (AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_Page_Load)
    **/
    window.onload = function () {
        require(["../js/GraduateEduPaper/gs_PaperGroupCRUDEx.js"], function (gs_papergroup) {
            var objPage = new gs_papergroup.gs_PaperGroupCRUDEx();
            objPage.Page_Load();
        });
    }
</script>
<script>
    // 将一个sheet转成最终的excel文件的blob对象，然后利用URL.createObjectURL下载
    function sheet2blob(sheet, sheetName) {
        sheetName = sheetName || 'sheet1';
        var workbook = {
            SheetNames: [sheetName],
            Sheets: {}
        }
        workbook.Sheets[sheetName] = sheet;
        // 生成excel的配置项
        var wopts = {
            bookType: 'xlsx', // 要生成的文件类型
            bookSST: false, // 是否生成Shared String Table，官方解释是，如果开启生成速度会下降，但在低版本IOS设备上有更好的兼容性
            type: 'binary'
        }
        var wbout = XLSX.write(workbook, wopts);
        var blob = new Blob([s2ab(wbout)], { type: "application/octet-stream" });
        // 字符串转ArrayBuffer
        function s2ab(s) {
            var buf = new ArrayBuffer(s.length);
            var view = new Uint8Array(buf);
            for (let i = 0; i != s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF;
            return buf;
        }
        return blob;
    }
    @*/**
* 通用的打开下载对话框方法，没有测试过具体兼容性
* @param url 下载地址，也可以是一个blob对象，必选
* @param saveName 保存文件名，可选
*/*@
        function openDownloadDialog(url, saveName) {
            if (typeof url == 'object' && url instanceof Blob) {
                url = URL.createObjectURL(url); // 创建blob地址
            }
            var aLink = document.createElement('a');
            aLink.href = url;
            aLink.download = saveName || ''; // HTML5新增的属性，指定保存文件名，可以不要后缀，注意，file:///模式下不会生效
            var event;
            if (window.MouseEvent) event = new MouseEvent('click');
            else {
                event = document.createEvent('MouseEvents');
                event.initMouseEvent('click', true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);
            }
            aLink.dispatchEvent(event);
        }
    //所有用户自定义的JS函数建议都放在这里
    function exportSpecialExcel_pyf(arrData, strFileName) {
        var sheet = XLSX.utils.aoa_to_sheet(arrData);
        openDownloadDialog(sheet2blob(sheet), strFileName);
    }
</script>
<div id="divLayout" class="div_layout">
    @*-- 标题层 --*@

    <div style="position: relative; width: 648px; height: 37px; left: 0px; top: 0px;">
        <label id="lblViewTitle" name="lblViewTitle" class="h5">
            论文分组CRUD
        </label>
        <label id="lblMsg_List" name="lblMsg_List" class="text-warning" style="width:250px;">
        </label>
    </div>
    @*-- 查询层 --*@

    <div id="divQuery" class="div_query">
        <table id="tabEdit" style="width:900px" class="table table-bordered table-hover table td table-sm">
            <tr>
                <td class="text-right">
                    <label id="lblPaperGroupName_q" name="lblPaperGroupName_q" class="col-form-label text-right" style="width:90px;">
                        组名
                    </label>
                </td>
                <td class="text-left">
                    <input id="txtPaperGroupName_q" name="txtPaperGroupName_q" class="form-control-sm" style="width:120px;" />
                </td>
                <td class="text-right">
                    <label id="lblUpdUser_q" name="lblUpdUser_q" class="col-form-label text-right" style="width:90px;">
                        用户
                    </label>
                </td>
                <td class="text-left">
                    <input id="txtUpdUser_q" name="txtUpdUser_q" class="form-control-sm" style="width:120px;" />
                </td>
            </tr>
        </table>
    </div>
    @*-- 功能区 --*@

    <div id="divFunction" class="table table-bordered table-hover">
        <ul class="nav">
            <li class="nav-item">
                <label id="lblgs_PaperGroupList" name="lblgs_PaperGroupList" class="col-form-label text-info" style="width:250px;">
                    论文分组列表
                </label>
            </li>
            <li class="nav-item ml-3">
                <button id="Query" name="Query" class="btn btn-outline-info btn-sm text-nowrap" onclick="btn_Click('Query')">查询</button>
            </li>
            <li class="nav-item ml-3">
                <button id="CreateWithMaxId" name="CreateWithMaxId" class="btn btn-outline-info btn-sm text-nowrap" onclick="btn_Click('CreateWithMaxId')">添加</button>
            </li>
            <li class="nav-item ml-3">
                <button id="Update" name="Update" class="btn btn-outline-info btn-sm text-nowrap" onclick="btn_Click('Update')">修改</button>
            </li>
            <li class="nav-item ml-3">
                <button id="Delete" name="Delete" class="btn btn-outline-info btn-sm text-nowrap" onclick="btn_Click('Delete')">删除</button>
            </li>
            <li class="nav-item ml-3">
                <button id="ExportExcel" name="ExportExcel" class="btn btn-outline-warning btn-sm text-nowrap" onclick="btn_Click('ExportExcel')">导出Excel</button>
            </li>
            <li class="nav-item ml-3">
                <div class="btn-group" role="group" aria-label="Basic example">
                    <input id="txtUpdUser_OrderNum" name="txtUpdUser_OrderNum" class="form-control-sm" style="width:60px;" />
                    <button id="GoTop" name="GoTop" class="btn btn-outline-info btn-sm text-nowrap" onclick="btn_Click('GoTop')">移顶</button>
                    <button id="UpMove" name="UpMove" class="btn btn-outline-info btn-sm text-nowrap" onclick="btn_Click('UpMove')">上移</button>
                    <button id="DownMove" name="DownMove" class="btn btn-outline-info btn-sm text-nowrap" onclick="btn_Click('DownMove')">下移</button>
                    <button id="GoBottum" name="GoBottum" class="btn btn-outline-info btn-sm text-nowrap" onclick="btn_Click('GoBottum')">移底</button>
                    <button id="ReOrder" name="ReOrder" class="btn btn-outline-info btn-sm text-nowrap" onclick="btn_Click('ReOrder')">重序</button>
                </div>
            </li>
        </ul>
    </div>
    @*-- 列表层 --*@
    <div id="divList" class="div_List">
        <div id="divDataLst" class="div_List">
        </div>
        <div id="divPager" class="pager">
        </div>
        <asp:HiddenField id="hidSortgs_PaperGroupBy" runat="server" />
    </div>
    @*-- 编辑层 --*@
    <div id="divEdit" value="1"></div>
    <input id="hidOpType" type="hidden" />
    <input id="hidKeyId" type="hidden" />
</div>