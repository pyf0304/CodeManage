@page
@{
    Layout = "~/Pages/Shared/_Layout_PC.cshtml";
    ViewData["Title"] = "PDF论文答疑";
}

@section Styles{
    <link rel="stylesheet" href="~/pdfjs2.3/web/viewer.css">
    <!-- This snippet is used in production (included from viewer.html) -->
    <link rel="resource" type="application/l10n" href="~/pdfjs2.3/web/locale/locale.properties">

    <link rel="stylesheet" href="../lib/bootstrap/dist/css/bootstrap.css" />
    <link rel="stylesheet" href="../css/site.css" />

    <link rel="stylesheet" href="~/lib/Xadmin/css/font.css">
    <link rel="stylesheet" href="~/lib/Xadmin/css/xadmin.css">
    <link rel="stylesheet" href="~/css/comment.css">
    <link rel="stylesheet" href="~/css/SimpleTree.css">

    <link rel="stylesheet" href="~/css/public.css" />



    @*js拖动分隔符样式*@
    <style type="text/css">
        * {
            padding: 0;
            margin: 0;
            list-style: none;
        }

        body, html {
            height: 100%;
        }

        body {
            padding: 0 40px;
        }

        .box {
            position: relative;
            height: calc(100% - 200px);
        }

        .bar {
            height: 100%;
            width: 7px;
            background: #d6d6d6;
            position: absolute;
            z-index: 1;
            left: 55%;
            top: 0;
            cursor: e-resize;
            opacity: 0;
        }

            .bar:hover {
                opacity: 1;
            }

        .left-part {
            position: absolute;
            left: 0;
            /*width: 250px;*/
            top: 0;
            bottom: 0;
            border: 1px solid #ddd;
            float: left;
            width: 55%;
            height: 100%;
            position: fixed;
            top: 40px;
            left: 1px;
            border-radius: 10px;
        }

        .right-part {
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            width: calc(45% - 0px);
        }

        .bar:after {
            display: block;
            position: absolute;
            left: 0;
            top: 50%;
            margin-top: -50px;
            width: 7px;
            height: 100px;
            content: " ";
            cursor: pointer;
            background: url(arrow.jpg) no-repeat center;
        }

        .resetBar:after {
            background: none;
            cursor: e-resize;
        }
    </style>

    <style>
        li {
            line-height: 30px;
        }

        .info {
            margin-top: 10px;
            border-bottom: solid 0px #dbdcde;
        }



        #leftPart {
            float: left;
            width: 55%;
            height: 100%;
            position: fixed;
            top: 40px;
            left: 1px;
            border-radius: 10px;
        }

        #rightPart {
            float: right;
            width: 45%;
            margin-top: 20px;
        }

        #list_Tags {
            border-radius: 5px;
            margin: 10px 10px 10px 10px;
            background-color: #fff;
            height: 220px;
            /*height: 400px;*/
            width: 100%;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .div_Questions {
            /*border-radius: 15px;*/
            /*margin-top: 15px;*/
            /*height: 350px;*/
        }

        #div_qa_Questions {
            border-radius: 5px;
            margin: 10px 10px 10px 10px;
            background-color: #fff;
            height: 400px;
            width: 100%;
            overflow-y: auto;
            overflow-x: hidden;
            /*overflow-x: scroll;*/
        }



        .div_Answer {
            margin-top: 5px;
            /*position: fixed;
            bottom: 1px;
            right: 0px;*/
        }

        #div_qa_Welcome {
            border-radius: 5px;
            background-color: beige;
            margin: 10px 10px 10px 10px;
            padding: 20px 20px 20px 20px;
        }

        .artlist li {
            line-height: 35px;
        }

        .rowtit {
            font-size: 16px;
        }

        #div_qa_Answer {
            border-radius: 5px;
            background-color: #fff;
            margin: 10px 10px 10px 10px;
            padding: 10px 10px 10px 10px;
            display: none;
            min-height: 450px;
        }

        #divEditQuestionsRegion {
            width: 100%;
            min-height: 450px;
            margin: 10px 10px 10px 10px;
            padding: 10px 10px 10px 10px;
            border-radius: 5px;
            background-color: #fff;
            display: none;
        }

        #divEditAnswerRegion {
            width: 100%;
            min-height: 450px;
            margin: 10px 10px 10px 10px;
            padding: 10px 10px 10px 10px;
            border-radius: 5px;
            background-color: #fff;
            display: none;
        }


        /*pdf高亮*/
        .text-span {
            background-color: crimson;
            /*color: red;*/
        }

        .liRowsColor {
            border: 1px solid #ddd;
            background-color: aliceblue;
            color: #fff;
        }

        /*批注提示图标样式*/
        .tipsIcon1 {
            opacity: 0.80;
            z-index: 1;
            filter: alpha(opacity=80);
        }

        .tipsIcon2 {
            opacity: 0.80;
            z-index: 1;
            filter: alpha(opacity=80);
        }
    </style>

}
@section Scripts{

    <script src="~/pdfjs2.3/build/pdf.js"></script>
    <script src="~/pdfjs2.3/web/viewer.js"></script>

    <script src="../lib/jquery/dist/jquery.js"></script>
    <script src="~/lib/Xadmin/lib/layui/layui.js" charset="utf-8"></script>
    <script type="text/javascript" src="~/lib/Xadmin/js/xadmin.js"></script>
    <script src="../lib/bootstrap/dist/js/bootstrap.js"></script>
    <script src="~/lib/at/AtPdf_QA.js"></script>

    <script type="text/javascript">

        //jQuery(document).ready(function () {
        //    //jQuery(".contenttext").mouseup(function (e) {
        //    jQuery("#leftPart").mouseup(function (e) {

        //        var txt;
        //        var page_Number = document.getElementById("pageNumber");

        //        var txt_PdfContent = document.getElementById("txtPdfContent");
        //        var txt_PdfPageNum = document.getElementById("txtPdfPageNum");

        //        var parentOffset = jQuery(this).offset();
        //        var x = e.pageX - parentOffset.left;
        //        var y = e.pageY - parentOffset.top;
        //        txt = window.getSelection();



        //        if (txt.toString().length > 1) {

        //            //$('#div_qa_Questions').hide();
        //            $('#div_qa_Answer').hide();

        //            $('#div_qa_Welcome').hide();
        //            $('#divEditAnswerRegion').hide();
        //            $('#divEditQuestionsRegion').show();

        //            if ($('#btnOKUpd1').html() != "确认修改") {
        //                $('#btnOKUpd1').html("确认添加");
        //                $('#btnCancel1').html("取消添加");

        //                $('#txtQuestionsContent').val("");
        //            }

        //            txt_PdfContent.value = txt;
        //            txt_PdfPageNum.value = page_Number.value;

        //        }
        //    });
        //});

        $(document).ready(function () {

            var selectedText;

            var bar = document.getElementById('bar'); //div分隔符
            var viewerContainer = document.getElementById('viewerContainer');//pdf悬浮层事件

            var leftPart = document.getElementById('leftPart');
            var rightPart = document.getElementById('rightPart');
            var defaultWidth = 936; // 默认宽度
            var ismove = false; // 用来判断是否移动了,区分点击和移动
            var startx = 0, x, oldx = defaultWidth;



            $("#leftPart").mouseup(function (e) {

                var pageNum = document.getElementById("pageNumber");
                //$(function () {
                //$("#leftPart").mouseup(function (e) {
                if (window.getSelection) {
                    selectedText = window.getSelection().toString();
                }
                else if (document.selection && document.selection.createRange) {
                    selectedText = document.selection.createRange().text;

                }
                //获取坐标位置
                GetTextLayer();
                $("#hidPdfPageNum").val(pageNum.value);
                $("#hidPdfContent").val(selectedText);
                if (selectedText) {
                    $("#icon").css({
                        "left": e.clientX + 1,
                        "top": e.clientY - 30

                    }).fadeIn(300);
                }
                else {
                    $("#icon").hide();
                }
            });
            /*增加注释*/
            $("#icon").hover(function () {
                $(this).children().removeClass("tipsIcon1");
            }, function () {
                $(this).children().addClass("tipsIcon1");
            })

            //.click(function () {
            //    $("#icon").hide();
            //    //AddQ(pageNum, selectedText);
            //    AddQ();
            //});

            /*增加答疑*/
            //$("#icon").hover(function () {
            //    $(this).children().removeClass("tipsIcon2");
            //}
            //    ,
            //    function () {
            //        $(this).children().addClass("tipsIcon2");
            //    }).click(function () {
            //        $("#icon").hide();
            //        //AddQ(pageNum, selectedText);
            //        ShowDialog('Add');
            //    });

            //div分隔符
            bar.addEventListener('mousedown', function (e) {
                ismove = false
                e.preventDefault();
                startx = e.clientX

                function move(e) {
                    ismove = true
                    x = oldx + e.clientX - startx
                    // 设置它距离左边最小值
                    if (x < 200) {
                        x = 200
                    }
                    bar.style.left = x + 'px'

                }

                function up(e) {
                    // 如果没有移动相当于发生了点击事件
                    if (ismove) {
                        leftPart.style.width = x + 'px'
                        rightPart.style.width = 'calc(100% - ' + x + 'px)'
                        oldx = x
                        // 如果距离默认值,设置可以点击回到默认状态
                        if (x != defaultWidth && bar.classList.contains('resetBar')) {
                            bar.classList.remove('resetBar')
                        }
                    } else {
                        var top = bar.getBoundingClientRect().top
                        // 相当于点击了箭头
                        if (e.clientY - top >= (bar.offsetHeight / 2 - 50) && e.clientY - top <= (bar.offsetHeight / 2 + 50)) {
                            leftPart.style.width = defaultWidth + 'px'
                            rightPart.style.width = 'calc(100% - ' + defaultWidth + 'px)'
                            bar.style.left = defaultWidth + 'px'
                            oldx = defaultWidth
                            bar.classList.add('resetBar')
                        }
                    }

                    document.removeEventListener('mousemove', move)
                    document.removeEventListener('mouseup', up)
                }
                document.addEventListener('mousemove', move, false)
                document.addEventListener('mouseup', up, false)
                //document.addEventListener('mouseup', AddT_Q(), false)
                //AddT_Q();

            }, false)


            //pdf悬浮层事件
            //viewerContainer.addEventListener("mousemove", btnPageNum_V_Click);

            ////显示pdfDiv
            //function btnPageNum_V_Click() {
            //    var page_Number = document.getElementById("pageNumber");
            //    //page_Number.value = PageNum;
            //    var PageNum = page_Number.value;
            //    //alert("当前页码" + PageNum);
            //    $("#hidPdfPageNum").val(PageNum);


            //}

        });




        function AddQ() {
            $("#icon").hide();
            //$('#div_qa_Questions').hide();
            $('#div_qa_Answer').hide();
            $('#div_qa_Welcome').hide();
            $('#divEditAnswerRegion').hide();


            $('#divEditQuestionsRegion').show();

            if ($('#btnOKUpd1').html() != "确认修改") {
                $('#btnOKUpd1').html("确认添加");
                $('#btnCancel1').html("取消添加");

                $('#txtQuestionsContent').val("");
            }


            //txt_PdfPageNum.value = pageNum;
            //txt_PdfContent.value = txt;
        }


        function AddT_Q() {
            //jQuery("#leftPart").mouseup(function (e) {

            var txt;
            var page_Number = document.getElementById("pageNumber");

            var txt_PdfContent = document.getElementById("txtPdfContent");
            var txt_PdfPageNum = document.getElementById("txtPdfPageNum");

            var parentOffset = jQuery(this).offset();
            var x = e.pageX - parentOffset.left;
            var y = e.pageY - parentOffset.top;
            txt = window.getSelection();



            if (txt.toString().length > 1) {

                //$('#div_qa_Questions').hide();
                $('#div_qa_Answer').hide();

                $('#div_qa_Welcome').hide();
                $('#divEditAnswerRegion').hide();
                $('#divEditQuestionsRegion').show();

                if ($('#btnOKUpd1').html() != "确认修改") {
                    $('#btnOKUpd1').html("确认添加");
                    $('#btnCancel1').html("取消添加");

                    $('#txtQuestionsContent').val("");
                }

                txt_PdfContent.value = txt;
                txt_PdfPageNum.value = page_Number.value;

            }
            //});
        }


        function getSelectText() {
            var txt = "";
            if (document.selection) {
                txt = document.selection.createRange().text;
            }

            else {
                txt = document.getSelection();
                //txt = window.getSelection();
            }

            return $.trim(txt.toString());
        }

        //function getPosition(e) {
        //    var x = 15;
        //    var y = 15;
        //    var r = getSelectText();
        //    if (r) {
        //        var bowen = r.toString();
        //        var tooltip = "<div id='tooltip' class='tooltip'><a href='javascript:void(0)' target='_blank'>" + bowen + "</a></div>";
        //        $("body").append(tooltip);
        //        $("#tooltip").css({
        //            "top": (e.pageY + y) + "px",
        //            "left": (e.pageX + x) + "px",
        //            "position": "absolute"
        //        }).show("fast");
        //    }

        //}

        //$(function () {
        //    $(".linkAnnotation").click(function () {
        //        alert("我被点击了")
        //    });
        //    //$('div').mousedown(
        //    //    function (e) {
        //    //        if (e.which == 3) {  // 1 = 鼠标左键 left; 2 = 鼠标中键; 3 = 鼠标右键
        //    //            //alert("按下的是鼠标右键");
        //    //            if (this.innerText.length == 0) return;
        //    //            var strStyle = this.style.top;
        //    //            $('#spnMsg').text(strStyle);
        //    //            alert(this.innerText + '鼠标右击了');
        //    //        }
        //    //        else {
        //    //            alert(this.innerText + '鼠标左击了');
        //    //        }
        //    //    });
        //    //$("div").mouseup(function (e) {
        //    //    var txt = getSelectText();
        //    //    txt = $.trim(txt);
        //    //    console.log('this', this);
        //    //    getPosition(e);
        //    //}).mousedown(function () {
        //    //    $("#tooltip").remove();
        //    //});

        //});


        function GetTextLayer() {
            var arrTextLayer = document.getElementsByClassName("textLayer");
            for (var i = 0; i < arrTextLayer.length; i++) {
                var objTextLayer = arrTextLayer[i];
                if (objTextLayer.childNodes.length > 0) {
                    for (var j = 0; j < objTextLayer.childNodes.length; j++) {
                        var objDiv = objTextLayer.childNodes[j];
                        //console.log('objDiv', objDiv);
                        //objDiv.addEventListener("mouseup",
                        objDiv.addEventListener("mousemove",
                            function (e) {
                                var txt = getSelectText();
                                txt = $.trim(txt);
                                console.log('this', this);
                                var strTop = this.style.top;
                                var strLeft = this.style.left;
                                var strMsg = 'Top:' + strTop + ';' + 'Text:' + this.innerText;

                                $('#pdfDiv_top').val(strTop);
                                $('#pdfDiv_left').val(strLeft);

                                console.log('strTop', strTop, 'strLeft', strLeft);
                                //getPosition(e);
                            });
                        //objDiv.addEventListener("mousedown", function () {
                        //    $("#tooltip").remove();
                        //});
                    }
                }
            }
            console.log("设置Div的选择事件完成！");
        }




        function pdf1_Click() {
            $("#hidPdfFile").val("https://www.sh-tz.com/GraduateStudyWebApp/UploadFiles/PaperUploadFile/中国MOOCs学习者价值研究_基于RFM模型的在线学习行为分析_宗阳20200329084605.pdf");
            myPdfWebViewerLoad();
        }

        function pdf2_Click() {
            $("#hidPdfFile").val("https://www.sh-tz.com/GraduateStudyWebApp/UploadFiles/PaperUploadFile/基于云计算与大数据的高职教育资源共享研究20200712025655.pdf");
            myPdfWebViewerLoad();
        }

        //var cursor;
        //var textQuestions = document.getElementById("txtQuestionsContent");
        //textQuestions.addEventListener('keyup', function (e) {

        //    //获取光标
        //    cursor = $("#txtQuestionsContent").selectionStart;
        //    require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {
        //        var objPage = new pdf_qa.Pdf_QA();
        //        objPage.txtQuestionsSubstring_Click(cursor);
        //    });

        //    // 当前光标所在位置的前一位为@字符，出现@选框

        //})
    </script>

    <script type="text/javascript">
        //var pdftxt = document.getElementById('leftPart');

        //var bar = document.getElementById('bar');
        //var leftPart = document.getElementById('leftPart');
        //var rightPart = document.getElementById('rightPart');
        //var defaultWidth = 936; // 默认宽度
        //var ismove = false; // 用来判断是否移动了,区分点击和移动
        //var startx = 0, x, oldx = defaultWidth;

        //bar.addEventListener('mousedown', function (e) {
        //    ismove = false
        //    e.preventDefault();
        //    startx = e.clientX

        //    function move(e) {
        //        ismove = true
        //        x = oldx + e.clientX - startx
        //        // 设置它距离左边最小值
        //        if (x < 200) {
        //            x = 200
        //        }
        //        bar.style.left = x + 'px'

        //    }

        //    function up(e) {
        //        // 如果没有移动相当于发生了点击事件
        //        if (ismove) {
        //            leftPart.style.width = x + 'px'
        //            rightPart.style.width = 'calc(100% - ' + x + 'px)'
        //            oldx = x
        //            // 如果距离默认值,设置可以点击回到默认状态
        //            if (x != defaultWidth && bar.classList.contains('resetBar')) {
        //                bar.classList.remove('resetBar')
        //            }
        //        } else {
        //            var top = bar.getBoundingClientRect().top
        //            // 相当于点击了箭头
        //            if (e.clientY - top >= (bar.offsetHeight / 2 - 50) && e.clientY - top <= (bar.offsetHeight / 2 + 50)) {
        //                leftPart.style.width = defaultWidth + 'px'
        //                rightPart.style.width = 'calc(100% - ' + defaultWidth + 'px)'
        //                bar.style.left = defaultWidth + 'px'
        //                oldx = defaultWidth
        //                bar.classList.add('resetBar')
        //            }
        //        }

        //        document.removeEventListener('mousemove', move)
        //        document.removeEventListener('mouseup', up)
        //    }
        //    document.addEventListener('mousemove', move, false)
        //    document.addEventListener('mouseup', up, false)
        //    //document.addEventListener('mouseup', AddT_Q(), false)
        //    //AddT_Q();

        //}, false)






    </script>



    <script src="../lib/require/require.js" data-main="../js/src/config"></script>
}



<script>
    window.onload = function () {
        $('#hidOrderbyId').val("1");
        Getqa_PaperId();
        require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {
            var objPage = new pdf_qa.Pdf_QA();
            objPage.Page_Load();
        });
    }

    function GetRequest() {
        var url = location.search; //获取url中"?"符后的字串
        var theRequest = new Object();
        if (url.indexOf("?") != -1) {
            var str = url.substr(1);
            strs = str.split("&");
            for (var i = 0; i < strs.length; i++) {
                theRequest[strs[i].split("=")[0]] = unescape(strs[i].split("=")[1]);
            }
        }
        return theRequest;
    }
    function Getqa_PaperId() {
        var Request = new Object();
        Request = GetRequest();

        var strid_CurrEduCls = Request['id_CurrEduCls'];
        var strqa_PaperId = Request['qa_PaperId'];
        var strQuestionsId = Request['QuestionsId'];
        var strPushId = Request['PushId'];
        var strPaperId = Request['PaperId'];
        var strTopicId = Request['TopicId'];


        if (strid_CurrEduCls != null) {
            $('#hidId_CurrEduCls').val(strid_CurrEduCls);
        }
        if (strqa_PaperId != null) {
            $('#hidqa_PaperId').val(strqa_PaperId);
        }
        if (strQuestionsId != null) {
            $('#hidQuestionsId').val(strQuestionsId);
        }
        if (strPushId != null) {
            $('#hidPushId').val(strPushId);
        }
        if (strPaperId != null) {
            $('#hidPaperId').val(strPaperId);
        }
        if (strTopicId != null) {
            $('#hidTopicId').val(strTopicId);
            $('#QA_back').hide();
            $('#TopicPdf').show();
        } else {
            $('#QA_back').show();
            $('#TopicPdf').hide();
        }


    }


    //设置div位置
    //function SetDivLertTop(pageNum, strDiv) {
    //function SetDivLertTop(PdfPageNum, TagsId, PdfDivTop, PdfDivLet, TagsContent) {

    //    var pdfPage = document.getElementsByClassName("page");

    //    var i;
    //    for (i = 1; i <= pdfPage.length; i++) {
    //        if (PdfPageNum == i) {

    //            var div = document.createElement("img");
    //            div.innerText = TagsContent;
    //            div.style.left = PdfDivLet;
    //            div.style.top = PdfDivTop;
    //            div.style.position = "absolute";
    //            div.style.zIndex = "999";
    //            //div.width = "200px";
    //            //div.height = "100px";
    //            div.title = TagsContent;
    //            div.id = TagsId;
    //            div.src = "/GraduateStudyWebApp/images/001_50.png";
    //            div.setAttribute("onclick", "btnUpdateTags_Click('" + TagsId + "')");

    //            //div.onclick = btnUpdateTags_Click(TagsId);

    //            //document.getElementById("myList").appendChild(div);
    //            //var node = document.createElement("div");
    //            //var textnode = document.createTextNode(strDiv);
    //            //node.appendChild(textnode);
    //            //document.getElementById("myList").appendChild(textnode);

    //            pdfPage[i-1].appendChild(div);
    //            //pdfPage[i].appendChild(textnode);
    //            //pdfPage[i].appendChild(strDiv);

    //        }
    //    }

    //}



    //点击问题显示答案
    function btnShowAnswer_Click(strKey, pageNum, pdfContent) {
        $('#div_qa_Welcome').hide();
        $('#div_qa_Answer').show();
        $('#hidQuestionsId').val(strKey);
        $('#hidPdfContent').val(pdfContent);
        //先清除背景色
        $("#infoSubViewpoint div").removeClass("liRowsColor");
        //添加背景色
        strKey = "Q" + strKey;
        $("#" + strKey).addClass("liRowsColor");

        //定位pdf页码
        var page_Number = document.getElementById("pageNumber");
        page_Number.value = pageNum;
        PDFViewerApplication.page = pageNum;



        require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {

            var objPage = new pdf_qa.Pdf_QA();
            objPage.btnShowAnswer_Click();
        });
    }
    ////////////////////////////////////////////////////问题//////////////////////////////////////////////////////

    /**显示绑定标注悬浮层 */
    function Showdiv_PdfQuestions_Click() {
        require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {
            var objPage = new pdf_qa.Pdf_QA();
            objPage.Showdiv_PdfQuestions();
        });
    }

    /*
 添加问题
(AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_btnAddNewRecord_Click)
*/
    function btnAddNewQuestions_Click() {
        require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {
            //ShowDialog('Add');
            //$('#div_qa_Questions').hide();
            $('#div_qa_Answer').hide();
            $('#divEditAnswerRegion').hide();
            $('#divEditQuestionsRegion').show();

            var objPage = new pdf_qa.Pdf_QA();
            objPage.btnAddNewQuestions_Click();
        });
    }
    /*
修改问题
(AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_btnAddNewRecord_Click)
*/
    function btnUpdateQuestions_Click(strKey) {
        $('#div_qa_Welcome').hide();
        $('#div_qa_Answer').hide();
        $('#divEditQuestionsRegion').show();
        require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {
            //ShowDialog('Add');
            //$('#div_qa_Questions').hide();

            var objPage = new pdf_qa.Pdf_QA();
            objPage.btnUpdateQuestions_Click(strKey);
        });
    }


    //锚点
    function btnIndexesQuestions_Click(strKeyId) {
        //先清除观点 和问题的 背景

        //先清除背景色
        $("#infoSubViewpoint div").removeClass("liRowsColor");
        //添加背景色
        strKeyId = "Q" + strKeyId;
        $("#" + strKeyId).addClass("liRowsColor");
        //$("#" + strKey).addClass("liRowsColor");
        //window.location.hash = "#Q" + strKeyId;
    }
    /*
删除问题
(AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_btnAddNewRecord_Click)
*/
    function btnDelQuestions_Click(strKey) {
        require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {
            var objPage = new pdf_qa.Pdf_QA();
            objPage.btnDelQuestions_Click(strKey);
        });
    }




    /*
 问题提交编辑
(AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_mySubmit)
*/
    function QuestionsSubmit(pstrOp) {
        //    alert("提交" + strOp);
        require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {
            var objPage = new pdf_qa.Pdf_QA();
            objPage.btnOKUpd1_Click();
        });
    }
    /*
取消问题
(AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_btnAddNewRecord_Click)
*/
    function btnCancel1_Click() {
        //$('#div_qa_Questions').show();
        $('#divEditQuestionsRegion').hide();
        $('#div_qa_Welcome').show();
        $('#btnOKUpd1').html("添加");
        $('#btnCancel1').html("取消编辑");
    }


    ////////////////////////////////////////////////////答案//////////////////////////////////////////////////////
    /*
添加答案
(AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_btnAddNewRecord_Click)
*/
    function btnAddNewAnswer_Click() {
        $("#hidParentId").val("root");
        require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {

            $('#div_qa_Answer').hide();
            $('#divEditAnswerRegion').show();
            var objPage = new pdf_qa.Pdf_QA();
            objPage.btnAddNewAnswer_Click();
        });
    }


    //回复弹窗
    function btnReplyAnswer_Click(strKeyId) {

        $('#hidParentId').val(strKeyId);
        require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {

            $('#div_qa_Answer').hide();
            $('#divEditAnswerRegion').show();
            var objPage = new pdf_qa.Pdf_QA();
            objPage.btnAddNewAnswer_Click();
        });

    }
    /*
修改答案
(AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_btnAddNewRecord_Click)
*/
    function btnUpdateAnswer_Click(strKey) {
        require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {
            //ShowDialog('Add');
            $('#div_qa_Answer').hide();
            $('#divEditAnswerRegion').show();
            var objPage = new pdf_qa.Pdf_QA();
            objPage.btnUpdateAnswer_Click(strKey);
        });
    }

    /*
删除问题
(AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_btnAddNewRecord_Click)
*/
    function btnDelAnswer_Click(strKey) {
        require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {
            var objPage = new pdf_qa.Pdf_QA();
            objPage.btnDelAnswer_Click(strKey);
        });
    }
    /*
 答案提交编辑
(AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_mySubmit)
*/
    function AnswerSubmit(pstrOp) {
        //    alert("提交" + strOp);
        require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {
            var objPage = new pdf_qa.Pdf_QA();
            objPage.btnOKUpd2_Click();
        });
    }
    /*
取消答案
(AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_btnAddNewRecord_Click)
*/
    function btnCancel2_Click() {
        $('#div_qa_Answer').show();
        $('#divEditAnswerRegion').hide();
    }




    //全部评论
    function AllQA_Click() {
        $('#hidOrderbyId').val("1");
        require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {
            var objPage = new pdf_qa.Pdf_QA();
            objPage.btnShowAnswer_Click();

            //layer.msg('已点赞!', {
            //    icon: 1,
            //    time: 2000
            //});
        });
    }

    //我的评论
    function MyQA_Click() {
        $('#hidOrderbyId').val("2");
        require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {
            var objPage = new pdf_qa.Pdf_QA();
            objPage.btnShowAnswer_Click();

            //layer.msg('已点赞!', {
            //    icon: 1,
            //    time: 2000
            //});
        });
    }

    //最新评论
    function NewQA_Click() {
        $('#hidOrderbyId').val("3");
        require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {
            var objPage = new pdf_qa.Pdf_QA();
            objPage.btnShowAnswer_Click();

            //layer.msg('已点赞!', {
            //    icon: 1,
            //    time: 2000
            //});
        });
    }

    /*
添加点赞
(AutoGCLib.WA_ViewScript_TS4CSharp:Gen_WApi_JS_btnAddNewRecord_Click)
*/
    function btnAddVote_Click(strKeyId, UserId) {
        //$('#hidSubViewpointId').val(strKeyId);
        require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {
            var objPage = new pdf_qa.Pdf_QA();
            objPage.btnAddVote_Click(strKeyId, UserId);
        });
    }

    function Alert1(strMsg) {

        layer.msg(strMsg, {
            icon: 1,
            time: 2000
        });
    }

    function Alert2(strMsg) {

        layer.msg(strMsg, {
            icon: 2,
            time: 2000
        });
    }

    function Alert3(strMsg) {

        layer.msg(strMsg, {
            icon: 3,
            time: 2000
        });
    }
    function Alert4(strMsg) {

        layer.msg(strMsg, {
            icon: 4,
            time: 2000
        });
    }

    //邀请其他同学回答
    function InviteOthers_Click(key) {

        $('#hidInviteKey').val(key);
        //Alert2('hi，功能还在搭建中....');
        require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {
            var objPage = new pdf_qa.Pdf_QA();
            objPage.InviteOthers_Click(key);
        });

        //atOthers();
    }

    //at弹出层教师学生数据
    function atOthers(strStuName, strTeaName) {
        layer.tab({
            area: ['500px', '400px'],
            tab: [{
                title: '同学',
                content: strStuName
            }, {
                title: '老师',
                content: strTeaName
            }]
        });

    }

    //确定at姓名
    function btnAtUserName_Click(strKey, strName) {

        require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {
            var objPage = new pdf_qa.Pdf_QA();
            objPage.btnAtUserName_Click(strKey, strName);
        });

        //atOthers();
    }

    function LayercClose() {
        //var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引
        //var index = layer.getFrameIndex(window.name); //先得到当前iframe层的索引
        //layer.close(index); //如果设定了yes回调，需进行手工关闭

        var index = layer.index
        layer.close(index);
    }

    //向左推移
    function right_Click() {
        var leftPart = document.getElementById("leftPart");
        var rightPart = document.getElementById("rightPart");

        var hidleftNum = document.getElementById("hidleftNum");
        var hidrightNum = document.getElementById("hidrightNum");

        var num = 5;
        hidleftNum.value = parseInt(hidleftNum.value) - num;
        hidrightNum.value = parseInt(hidrightNum.value) + num;

        leftPart.style.width = hidleftNum.value + '%';
        rightPart.style.width = hidrightNum.value + '%';

        layer.msg('答疑内容增宽到：' + hidrightNum.value + '%', {
            icon: 1,
            time: 2000
        });
    }


    //向右推移
    function left_Click() {
        var leftPart = document.getElementById("leftPart");
        var rightPart = document.getElementById("rightPart");

        var hidleftNum = document.getElementById("hidleftNum");
        var hidrightNum = document.getElementById("hidrightNum");

        var num = 5;
        hidleftNum.value = parseInt(hidleftNum.value) + num;
        hidrightNum.value = parseInt(hidrightNum.value) - num;
        leftPart.style.width = hidleftNum.value + '%';
        rightPart.style.width = hidrightNum.value + '%';
        layer.msg('pdf增宽到：' + hidleftNum.value + '%', {
            icon: 1,
            time: 2000
        });
    }

    //var cursor;
    //var textQuestions = document.getElementById("txtQuestionsContent");
    //$("#txtQuestionsContent").keyup(function () {
    //    //$("input").css("background-color", "pink");
    //    //获取光标
    //    cursor = $("#txtQuestionsContent").selectionStart;
    //    require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {
    //        var objPage = new pdf_qa.Pdf_QA();
    //        objPage.txtQuestionsSubstring_Click(cursor);
    //    });
    //});


    //textQuestions.addEventListener('keyup', function (e) {

    //    //获取光标
    //    cursor = $("#txtQuestionsContent").selectionStart;
    //    require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {
    //        var objPage = new pdf_qa.Pdf_QA();
    //        objPage.txtQuestionsSubstring_Click(cursor);
    //    });

    //    // 当前光标所在位置的前一位为@字符，出现@选框

    //})

    /**
     * ******************************************************pdf标注****************************************************
     */


    /**显示绑定标注悬浮层 */
    function Showdiv_PdfTags_Click() {
        require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {
            var objPage = new pdf_qa.Pdf_QA();
            objPage.Showdiv_PdfTags();
        });
    }


    /*
     *
  显示对话框
 (AutoGCLib.WA_ViewScript_TS4CSharp:Gen_WApi_JS_ShowDialog)
 */
    function ShowDialog(pstrOp) {
        $("#icon").hide();

        strOp = pstrOp;
        require(['jquery', 'bootstrap'], function ($) {
            if (strOp === "Add") {
                $("#txtTagsContent").val("");
                $('#myModalLabel').html('添加标注');

                $('#btnOKUpd3').html('添加标注');

                //Paper_QUDI.GetMaxStrId('#txtPaperId');
            }
            else if (strOp === "Update") {
                $('#myModalLabel').html('修改标注');
                $('#btnOKUpd3').html('修改标注');
            }
            else if (strOp === "Detail") {
                $('#btnOKUpd').hide();
                $('#myModalLabel').html('详细信息');
            }
            $('#divEditTagsRegion').modal('show');
        });
    }

    /*
     隐藏对话框
    (AutoGCLib.WA_ViewScript_TS4CSharp:Gen_WApi_JS_HideDialog)
    */
    function HideDialog() {
        require(['jquery', 'bootstrap'], function ($) {
            $('#divEditTagsRegion').modal('hide');
        });
    }


    /*标注提交编辑
(AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_mySubmit)
*/
    function TagsSubmit(pstrOp) {
        //    alert("提交" + strOp);
        require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {
            var objPage = new pdf_qa.Pdf_QA();
            objPage.btnOKUpd3_Click();
        });
    }

    //修改标记
    function btnUpdateTags_Click(strKey) {

        require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {
            $("#txtTagsContent").val("");
            ShowDialog('Update');

            var objPage = new pdf_qa.Pdf_QA();
            objPage.btnUpdateTags_Click(strKey);
        });
    }


    /*
删除标记
(AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_btnAddNewRecord_Click)
*/
    function btnDelTags_Click(strKey) {
        require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {
            var objPage = new pdf_qa.Pdf_QA();
            objPage.btnDelTags_Click(strKey);
        });
    }


    //点击标题定位pdf
    function btnShowTags_Click(strKey, pageNum, pdfContent) {
        $('#hidTagsId').val(strKey);
        $('#hidPdfContent').val(pdfContent);

        //先清除背景色
        $("#infoTages div").removeClass("liRowsColor");
        //添加背景色
        strKey = "T" + strKey;
        $("#" + strKey).addClass("liRowsColor");

        //定位pdf页码
        var page_Number = document.getElementById("pageNumber");
        page_Number.value = pageNum;
        PDFViewerApplication.page = pageNum;

        //$('#div_qa_Welcome').hide();
        //$('#div_qa_Answer').show();


        require(["../js/InteractManage/Pdf_QA.js"], function (pdf_qa) {

            var objPage = new pdf_qa.Pdf_QA();
            //objPage.btnShowTags_Click();
            //添加高亮
            objPage.btnUpdatePaperPageNum_Click(pdfContent);

        });
    }

    //锚点
    function btnIndexesTags_Click(strKeyId) {
        //先清除观点 和问题的 背景

        //先清除背景色
        $("#infoTages div").removeClass("liRowsColor");
        //添加背景色
        var strKey = "T" + strKeyId;
        $("#" + strKey).addClass("liRowsColor");
        //$("#" + strKey).addClass("liRowsColor");
        //window.location.hash = "#T" + strKeyId;
    }

    //隐藏显示标注
    function DisplayTags_Click() {
        var strMsg;
        if ($("#DisplayTags").html() == "隐藏标注") {
            $("#DisplayTags").html("显示标注")
            strMsg = "已隐藏标注";
            $("#div_Tags").hide();
            $("#div_qa_Questions").css({ "height": "600px" });

        } else {
            $("#DisplayTags").html("隐藏标注")
            strMsg = "已显示标注";
            $("#div_Tags").show();

            $("#list_Tags").css({ "height": "200px" });
            $("#div_qa_Questions").css({ "height": "400px" });
        }
        layer.msg(strMsg, {
            icon: 1,
            time: 2000
        });
    }


    //隐藏显示答疑
    function DisplayQ_Click() {
        var strMsg;
        if ($("#DisplayQ").html() == "隐藏答疑") {
            $("#DisplayQ").html("显示答疑")
            strMsg = "已隐藏答疑";
            $("#div_Questions").hide();
            $("#list_Tags").css({ "height": "600px" });

        } else {
            $("#DisplayQ").html("隐藏答疑")
            strMsg = "已显示答疑";
            $("#div_Questions").show();

            $("#list_Tags").css({ "height": "200px" });
            $("#div_qa_Questions").css({ "height": "400px" });
        }
        layer.msg(strMsg, {
            icon: 1,
            time: 2000
        });
    }

    //跳转到主题PDF页面
    function TopicPdf_Click() {
        var strqa_PaperId = $('#hidqa_PaperId').val();
        var strPaperId = $('#hidPaperId').val();
        var strTopicId = $('#hidTopicId').val();

        window.location.href = "../InteractManage/Pdf_QA_Topic?TopicId=" + strTopicId + "&qa_PaperId=" + strqa_PaperId + "&PaperId=" + strPaperId;

    }


</script>



<div id="divLoading" class="loading">
    <img src="~/images/CirclePoint.gif" />
</div>
@*<a id="backtop" class="back-top" href="javascript:scroll(0,0);" target="_self" title="返回顶部" style="display: block;">
        <i class="icon-backtop"></i>
    </a>*@
<div class="x-nav" style="position:fixed;top:1px;left:1px;right:1px;width:100%;">
    <span class="layui-breadcrumb">
        <a href="">首页</a>
        <a href="">答疑管理</a>
        <a>
            <cite>pdf论文答疑</cite>
        </a>
        <Label id="lblMsg_List" name="lblMsg_List"></Label>
    </span>
    <a class="layui-btn layui-btn-small" style="line-height:1.6em;float:right;margin-top:3px; color:#fff;" onclick="location.reload()" title="刷新">
        <i class="layui-icon layui-icon-refresh-3" style="line-height:32px"></i>
    </a>
    @*<button class="layui-btn layui-btn-danger" style="float:right;margin-right:10px;margin-top:3px;" onclick="javascript:history.go(-1)" title="返回">
            <i class="layui-icon layui-icon-return" style="line-height:30px"></i>
        </button>*@
    <a id="QA_back" class="layui-btn layui-btn-danger" style="line-height:1.6em;margin-top:3px;float:right;margin-left:50px; margin-right:10px; color:#fff;" onclick="javascript:history.go(-1)" title="返回">
        <i class="layui-icon layui-icon-return" style="line-height:32px"></i>
    </a>

    <a class="layui-btn layui-btn-normal" style="line-height:1.6em;margin-top:3px; float:right; color:#fff;" onclick="left_Click()" title="向右推移">
        <i class="layui-icon layui-icon-spread-left" style="line-height:32px"></i>
    </a>


    <a class="layui-btn layui-btn-normal" style="line-height:1.6em;margin-top:3px;float:right; color:#fff;" onclick="right_Click()" title="向左推移">
        <i class="layui-icon layui-icon-shrink-right" style="line-height:32px"></i>
    </a>


    <a id="DisplayQ" class="layui-btn layui-btn-normal" style="line-height:2.2em;margin-top:3px;float:right; color:#fff;" onclick="DisplayQ_Click()">隐藏答疑</a>
    <a id="DisplayTags" class="layui-btn layui-btn-normal" style="line-height:2.2em;margin-top:3px;float:right; color:#fff;" onclick="DisplayTags_Click()">隐藏标注</a>

    <a id="TopicPdf" class="layui-btn layui-btn-normal" style="line-height:2.2em;margin-top:3px;float:right; color:#fff;" onclick="TopicPdf_Click()">主题PDF答疑</a>
    @*<a id="pdf2" class="layui-btn layui-btn-normal" style="line-height:2.2em;margin-top:3px;float:right; color:#fff;" onclick="pdf2_Click()">pdf2</a>*@

</div>
<div style="width:100%; height:100%;">
    @*<div id="leftPart">*@
    <div class="left-part" id="leftPart">
        <div id="outerContainer">
            <div id="sidebarContainer">
                <div id="toolbarSidebar">
                    <div class="splitToolbarButton toggled">
                        <button id="viewThumbnail" class="toolbarButton toggled" title="Show Thumbnails" tabindex="2" data-l10n-id="thumbs">
                            <span data-l10n-id="thumbs_label">Thumbnails</span>
                        </button>
                        <button id="viewOutline" class="toolbarButton" title="Show Document Outline (double-click to expand/collapse all items)" tabindex="3" data-l10n-id="document_outline">
                            <span data-l10n-id="document_outline_label">Document Outline</span>
                        </button>
                        <button id="viewAttachments" class="toolbarButton" title="Show Attachments" tabindex="4" data-l10n-id="attachments">
                            <span data-l10n-id="attachments_label">Attachments</span>
                        </button>
                    </div>
                </div>
                <div id="sidebarContent">
                    <div id="thumbnailView">
                    </div>
                    <div id="outlineView" class="hidden">
                    </div>
                    <div id="attachmentsView" class="hidden">
                    </div>
                </div>
                <div id="sidebarResizer" class="hidden"></div>
            </div>  <!-- sidebarContainer -->
            <div id="mainContainer">
                <div class="findbar hidden doorHanger" id="findbar">
                    <div id="findbarInputContainer">
                        <input id="findInput" class="toolbarField" title="Find" placeholder="Find in document…" tabindex="91" data-l10n-id="find_input">
                        <div class="splitToolbarButton">
                            <button id="findPrevious" class="toolbarButton findPrevious" title="Find the previous occurrence of the phrase" tabindex="92" data-l10n-id="find_previous">
                                <span data-l10n-id="find_previous_label">Previous</span>
                            </button>
                            <div class="splitToolbarButtonSeparator"></div>
                            <button id="findNext" class="toolbarButton findNext" title="Find the next occurrence of the phrase" tabindex="93" data-l10n-id="find_next">
                                <span data-l10n-id="find_next_label">Next</span>
                            </button>
                        </div>
                    </div>
                    <div id="findbarOptionsOneContainer">
                        <input type="checkbox" id="findHighlightAll" class="toolbarField" tabindex="94">
                        <label for="findHighlightAll" class="toolbarLabel" data-l10n-id="find_highlight">Highlight all</label>
                        <input type="checkbox" id="findMatchCase" class="toolbarField" tabindex="95">
                        <label for="findMatchCase" class="toolbarLabel" data-l10n-id="find_match_case_label">Match case</label>
                    </div>
                    <div id="findbarOptionsTwoContainer">
                        <input type="checkbox" id="findEntireWord" class="toolbarField" tabindex="96">
                        <label for="findEntireWord" class="toolbarLabel" data-l10n-id="find_entire_word_label">Whole words</label>
                        <span id="findResultsCount" class="toolbarLabel hidden"></span>
                    </div>
                    <div id="findbarMessageContainer">
                        <span id="findMsg" class="toolbarLabel"></span>
                    </div>
                </div>  <!-- findbar -->
                <div id="secondaryToolbar" class="secondaryToolbar hidden doorHangerRight">
                    <div id="secondaryToolbarButtonContainer">
                        <button id="secondaryPresentationMode" class="secondaryToolbarButton presentationMode visibleLargeView" title="Switch to Presentation Mode" tabindex="51" data-l10n-id="presentation_mode">
                            <span data-l10n-id="presentation_mode_label">Presentation Mode</span>
                        </button>
                        <button id="secondaryOpenFile" class="secondaryToolbarButton openFile visibleLargeView" title="Open File" tabindex="52" data-l10n-id="open_file">
                            <span data-l10n-id="open_file_label">Open</span>
                        </button>
                        <button id="secondaryPrint" class="secondaryToolbarButton print visibleMediumView" title="Print" tabindex="53" data-l10n-id="print">
                            <span data-l10n-id="print_label">Print</span>
                        </button>
                        <button id="secondaryDownload" class="secondaryToolbarButton download visibleMediumView" title="Download" tabindex="54" data-l10n-id="download">
                            <span data-l10n-id="download_label">Download</span>
                        </button>
                        <a href="#" id="secondaryViewBookmark" class="secondaryToolbarButton bookmark visibleSmallView" title="Current view (copy or open in new window)" tabindex="55" data-l10n-id="bookmark">
                            <span data-l10n-id="bookmark_label">Current View</span>
                        </a>
                        <div class="horizontalToolbarSeparator visibleLargeView"></div>
                        <button id="firstPage" class="secondaryToolbarButton firstPage" title="Go to First Page" tabindex="56" data-l10n-id="first_page">
                            <span data-l10n-id="first_page_label">Go to First Page</span>
                        </button>
                        <button id="lastPage" class="secondaryToolbarButton lastPage" title="Go to Last Page" tabindex="57" data-l10n-id="last_page">
                            <span data-l10n-id="last_page_label">Go to Last Page</span>
                        </button>
                        <div class="horizontalToolbarSeparator"></div>
                        <button id="pageRotateCw" class="secondaryToolbarButton rotateCw" title="Rotate Clockwise" tabindex="58" data-l10n-id="page_rotate_cw">
                            <span data-l10n-id="page_rotate_cw_label">Rotate Clockwise</span>
                        </button>
                        <button id="pageRotateCcw" class="secondaryToolbarButton rotateCcw" title="Rotate Counterclockwise" tabindex="59" data-l10n-id="page_rotate_ccw">
                            <span data-l10n-id="page_rotate_ccw_label">Rotate Counterclockwise</span>
                        </button>
                        <div class="horizontalToolbarSeparator"></div>
                        <button id="cursorSelectTool" class="secondaryToolbarButton selectTool toggled" title="Enable Text Selection Tool" tabindex="60" data-l10n-id="cursor_text_select_tool">
                            <span data-l10n-id="cursor_text_select_tool_label">Text Selection Tool</span>
                        </button>
                        <button id="cursorHandTool" class="secondaryToolbarButton handTool" title="Enable Hand Tool" tabindex="61" data-l10n-id="cursor_hand_tool">
                            <span data-l10n-id="cursor_hand_tool_label">Hand Tool</span>
                        </button>
                        <div class="horizontalToolbarSeparator"></div>
                        <button id="scrollVertical" class="secondaryToolbarButton scrollModeButtons scrollVertical toggled" title="Use Vertical Scrolling" tabindex="62" data-l10n-id="scroll_vertical">
                            <span data-l10n-id="scroll_vertical_label">Vertical Scrolling</span>
                        </button>
                        <button id="scrollHorizontal" class="secondaryToolbarButton scrollModeButtons scrollHorizontal" title="Use Horizontal Scrolling" tabindex="63" data-l10n-id="scroll_horizontal">
                            <span data-l10n-id="scroll_horizontal_label">Horizontal Scrolling</span>
                        </button>
                        <button id="scrollWrapped" class="secondaryToolbarButton scrollModeButtons scrollWrapped" title="Use Wrapped Scrolling" tabindex="64" data-l10n-id="scroll_wrapped">
                            <span data-l10n-id="scroll_wrapped_label">Wrapped Scrolling</span>
                        </button>
                        <div class="horizontalToolbarSeparator scrollModeButtons"></div>
                        <button id="spreadNone" class="secondaryToolbarButton spreadModeButtons spreadNone toggled" title="Do not join page spreads" tabindex="65" data-l10n-id="spread_none">
                            <span data-l10n-id="spread_none_label">No Spreads</span>
                        </button>
                        <button id="spreadOdd" class="secondaryToolbarButton spreadModeButtons spreadOdd" title="Join page spreads starting with odd-numbered pages" tabindex="66" data-l10n-id="spread_odd">
                            <span data-l10n-id="spread_odd_label">Odd Spreads</span>
                        </button>
                        <button id="spreadEven" class="secondaryToolbarButton spreadModeButtons spreadEven" title="Join page spreads starting with even-numbered pages" tabindex="67" data-l10n-id="spread_even">
                            <span data-l10n-id="spread_even_label">Even Spreads</span>
                        </button>
                        <div class="horizontalToolbarSeparator spreadModeButtons"></div>
                        <button id="documentProperties" class="secondaryToolbarButton documentProperties" title="Document Properties…" tabindex="68" data-l10n-id="document_properties">
                            <span data-l10n-id="document_properties_label">Document Properties…</span>
                        </button>
                    </div>
                </div>  <!-- secondaryToolbar -->
                <div class="toolbar">
                    <div id="toolbarContainer">
                        <div id="toolbarViewer">
                            <div id="toolbarViewerLeft">
                                <button id="sidebarToggle" class="toolbarButton" title="Toggle Sidebar" tabindex="11" data-l10n-id="toggle_sidebar">
                                    <span data-l10n-id="toggle_sidebar_label">Toggle Sidebar</span>
                                </button>
                                <div class="toolbarButtonSpacer"></div>
                                <button id="viewFind" class="toolbarButton" title="Find in Document" tabindex="12" data-l10n-id="findbar">
                                    <span data-l10n-id="findbar_label">Find</span>
                                </button>
                                <div class="splitToolbarButton hiddenSmallView">
                                    <button class="toolbarButton pageUp" title="Previous Page" id="previous" tabindex="13" data-l10n-id="previous">
                                        <span data-l10n-id="previous_label">Previous</span>
                                    </button>
                                    <div class="splitToolbarButtonSeparator"></div>
                                    <button class="toolbarButton pageDown" title="Next Page" id="next" tabindex="14" data-l10n-id="next">
                                        <span data-l10n-id="next_label">Next</span>
                                    </button>
                                </div>
                                <input type="number" id="pageNumber" class="toolbarField pageNumber" title="Page" value="1" size="4" min="1" tabindex="15" data-l10n-id="page">
                                <span id="numPages" class="toolbarLabel"></span>
                            </div>
                            <div id="toolbarViewerRight">
                                <button id="presentationMode" class="toolbarButton presentationMode hiddenLargeView" title="Switch to Presentation Mode" tabindex="31" data-l10n-id="presentation_mode">
                                    <span data-l10n-id="presentation_mode_label">Presentation Mode</span>
                                </button>
                                <button id="openFile" class="toolbarButton openFile hiddenLargeView" title="Open File" tabindex="32" data-l10n-id="open_file">
                                    <span data-l10n-id="open_file_label">Open</span>
                                </button>
                                <button id="print" class="toolbarButton print hiddenMediumView" title="Print" tabindex="33" data-l10n-id="print">
                                    <span data-l10n-id="print_label">Print</span>
                                </button>
                                <button id="download" class="toolbarButton download hiddenMediumView" title="Download" tabindex="34" data-l10n-id="download">
                                    <span data-l10n-id="download_label">Download</span>
                                </button>
                                <a href="#" id="viewBookmark" class="toolbarButton bookmark hiddenSmallView" title="Current view (copy or open in new window)" tabindex="35" data-l10n-id="bookmark">
                                    <span data-l10n-id="bookmark_label">Current View</span>
                                </a>
                                <div class="verticalToolbarSeparator hiddenSmallView"></div>
                                <button id="secondaryToolbarToggle" class="toolbarButton" title="Tools" tabindex="36" data-l10n-id="tools">
                                    <span data-l10n-id="tools_label">Tools</span>
                                </button>
                            </div>
                            <div id="toolbarViewerMiddle">
                                <div class="splitToolbarButton">
                                    <button id="zoomOut" class="toolbarButton zoomOut" title="Zoom Out" tabindex="21" data-l10n-id="zoom_out">
                                        <span data-l10n-id="zoom_out_label">Zoom Out</span>
                                    </button>
                                    <div class="splitToolbarButtonSeparator"></div>
                                    <button id="zoomIn" class="toolbarButton zoomIn" title="Zoom In" tabindex="22" data-l10n-id="zoom_in">
                                        <span data-l10n-id="zoom_in_label">Zoom In</span>
                                    </button>
                                </div>
                                <span id="scaleSelectContainer" class="dropdownToolbarButton">
                                    <select id="scaleSelect" title="Zoom" tabindex="23" data-l10n-id="zoom">
                                        <option id="pageAutoOption" title="" value="auto" selected="selected" data-l10n-id="page_scale_auto">Automatic Zoom</option>
                                        <option id="pageActualOption" title="" value="page-actual" data-l10n-id="page_scale_actual">Actual Size</option>
                                        <option id="pageFitOption" title="" value="page-fit" data-l10n-id="page_scale_fit">Page Fit</option>
                                        <option id="pageWidthOption" title="" value="page-width" data-l10n-id="page_scale_width">Page Width</option>
                                        <option id="customScaleOption" title="" value="custom" disabled="disabled" hidden="true"></option>
                                        <option title="" value="0.5" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 50 }'>50%</option>
                                        <option title="" value="0.75" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 75 }'>75%</option>
                                        <option title="" value="1" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 100 }'>100%</option>
                                        <option title="" value="1.25" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 125 }'>125%</option>
                                        <option title="" value="1.5" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 150 }'>150%</option>
                                        <option title="" value="2" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 200 }'>200%</option>
                                        <option title="" value="3" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 300 }'>300%</option>
                                        <option title="" value="4" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 400 }'>400%</option>
                                    </select>
                                </span>
                            </div>
                        </div>
                        <div id="loadingBar">
                            <div class="progress">
                                <div class="glimmer">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <menu type="context" id="viewerContextMenu">
                    <menuitem id="contextFirstPage" label="First Page"
                              data-l10n-id="first_page"></menuitem>
                    <menuitem id="contextLastPage" label="Last Page"
                              data-l10n-id="last_page"></menuitem>
                    <menuitem id="contextPageRotateCw" label="Rotate Clockwise"
                              data-l10n-id="page_rotate_cw"></menuitem>
                    <menuitem id="contextPageRotateCcw" label="Rotate Counter-Clockwise"
                              data-l10n-id="page_rotate_ccw"></menuitem>
                </menu>
                <div id="viewerContainer" tabindex="0">
                    <div id="viewer" class="pdfViewer">
                        @*<div id="pdfdivTop_Left"></div>*@
                    </div>


                </div>
                <div id="errorWrapper" hidden='true'>
                    <div id="errorMessageLeft">
                        <span id="errorMessage"></span>
                        <button id="errorShowMore" data-l10n-id="error_more_info">
                            More Information
                        </button>
                        <button id="errorShowLess" data-l10n-id="error_less_info" hidden='true'>
                            Less Information
                        </button>
                    </div>
                    <div id="errorMessageRight">
                        <button id="errorClose" data-l10n-id="error_close">
                            Close
                        </button>
                    </div>
                    <div class="clearBoth"></div>
                    <textarea id="errorMoreInfo" hidden='true' readonly="readonly"></textarea>
                </div>
            </div> <!-- mainContainer -->
            <div id="overlayContainer" class="hidden">
                <div id="passwordOverlay" class="container hidden">
                    <div class="dialog">
                        <div class="row">
                            <p id="passwordText" data-l10n-id="password_label">Enter the password to open this PDF file:</p>
                        </div>
                        <div class="row">
                            <input type="password" id="password" class="toolbarField">
                        </div>
                        <div class="buttonRow">
                            <button id="passwordCancel" class="overlayButton"><span data-l10n-id="password_cancel">Cancel</span></button>
                            <button id="passwordSubmit" class="overlayButton"><span data-l10n-id="password_ok">OK</span></button>
                        </div>
                    </div>
                </div>
                <div id="documentPropertiesOverlay" class="container hidden">
                    <div class="dialog">
                        <div class="row">
                            <span data-l10n-id="document_properties_file_name">File name:</span> <p id="fileNameField">-</p>
                        </div>
                        <div class="row">
                            <span data-l10n-id="document_properties_file_size">File size:</span> <p id="fileSizeField">-</p>
                        </div>
                        <div class="separator"></div>
                        <div class="row">
                            <span data-l10n-id="document_properties_title">Title:</span> <p id="titleField">-</p>
                        </div>
                        <div class="row">
                            <span data-l10n-id="document_properties_author">Author:</span> <p id="authorField">-</p>
                        </div>
                        <div class="row">
                            <span data-l10n-id="document_properties_subject">Subject:</span> <p id="subjectField">-</p>
                        </div>
                        <div class="row">
                            <span data-l10n-id="document_properties_keywords">Keywords:</span> <p id="keywordsField">-</p>
                        </div>
                        <div class="row">
                            <span data-l10n-id="document_properties_creation_date">Creation Date:</span> <p id="creationDateField">-</p>
                        </div>
                        <div class="row">
                            <span data-l10n-id="document_properties_modification_date">Modification Date:</span> <p id="modificationDateField">-</p>
                        </div>
                        <div class="row">
                            <span data-l10n-id="document_properties_creator">Creator:</span> <p id="creatorField">-</p>
                        </div>
                        <div class="separator"></div>
                        <div class="row">
                            <span data-l10n-id="document_properties_producer">PDF Producer:</span> <p id="producerField">-</p>
                        </div>
                        <div class="row">
                            <span data-l10n-id="document_properties_version">PDF Version:</span> <p id="versionField">-</p>
                        </div>
                        <div class="row">
                            <span data-l10n-id="document_properties_page_count">Page Count:</span> <p id="pageCountField">-</p>
                        </div>
                        <div class="row">
                            <span data-l10n-id="document_properties_page_size">Page Size:</span> <p id="pageSizeField">-</p>
                        </div>
                        <div class="separator"></div>
                        <div class="row">
                            <span data-l10n-id="document_properties_linearized">Fast Web View:</span> <p id="linearizedField">-</p>
                        </div>
                        <div class="buttonRow">
                            <button id="documentPropertiesClose" class="overlayButton"><span data-l10n-id="document_properties_close">Close</span></button>
                        </div>
                    </div>
                </div>
                <div id="printServiceOverlay" class="container hidden">
                    <div class="dialog">
                        <div class="row">
                            <span data-l10n-id="print_progress_message">Preparing document for printing…</span>
                        </div>
                        <div class="row">
                            <progress value="0" max="100"></progress>
                            <span data-l10n-id="print_progress_percent" data-l10n-args='{ "progress": 0 }' class="relative-progress">0%</span>
                        </div>
                        <div class="buttonRow">
                            <button id="printCancel" class="overlayButton"><span data-l10n-id="print_progress_close">Cancel</span></button>
                        </div>
                    </div>
                </div>
            </div>  <!-- overlayContainer -->
        </div>
        <!-- outerContainer -->
        <div id="printContainer"></div>



        @*<div id="pdfdivTop_Left"></div>*@




        <div id="icon" style="display: none; position: absolute;">

            <img id="tipsIcon1" src="~/images/QA.png" class="tipsIcon1" style="height:24px;width:24px;" title="添加答疑" onclick="AddQ()">
            <img id="tipsIcon2" src="~/images/001_50.png" class="tipsIcon2" style="height:24px;width:24px;" title="添加批注" onclick="ShowDialog('Add')">
        </div>
    </div>

    @* 中间拖动层 *@
    <div id="bar" class="bar resetBar"></div>
    @*<div id="rightPart">*@
    <div class="right-part" id="rightPart">
        @* 标注 *@
        <div id="div_Tags" class="div_Tags">
            <div id="list_Tags"></div>
        </div>
        @* 问题 *@
        <div id="div_Questions" class="div_Questions">
            @*-- 问题显示列表 --*@
            <div id="div_qa_Questions">

            </div>
        </div>
        @* 欢迎 *@
        <div id="div_qa_Welcome">
            <div style="text-align:center;"><h2>欢迎来到研究生论文答疑</h2></div>
            <ul>
                <li class="rowtit color1">选中左边的pdf文字可以创建新的问题或者标注，问题可推送给其他人</li>
                <li class="rowtit color2">选中右边的问题可以在问题下面显示回答，并追踪到pdf页码</li>
                <li class="rowtit color3">选中问题可以在显示回答区对问题进行回复、并可以对自己的回答修改、删除</li>
                <li class="rowtit color4">选中回答可以对父类回答进行回复</li>
            </ul>
        </div>

        @*-- 答案显示列表 --*@
        <div id="div_qa_Answer">
            <div class="divComment">
                <div class="comment-short" id="J_Short">

                    <div class="comment-title" style="margin-top:5px;">
                        <p class="comment-all" onclick="AllQA_Click()">全部回答</p>
                        <div class="comment-center" id="J_CommentCenter">
                            <span class="comment-center-slash">/</span>
                            <span class="comment-my J_userCenter" onclick="MyQA_Click()">我的回答</span>
                            <span class="comment-center-slash">/</span>
                            <span class="comment-my J_userCenter" onclick="NewQA_Click()">最新回答</span>
                        </div>
                        <p class="comment-sort">
                            @* <span data-targetid="4760694256" data-sort="1" class="J_CommentSort comment-sort-cur" onclick="NewQA_Click()">最新</span> &nbsp;/&nbsp;*@
                            @*<span data-targetid="4760694256" data-sort="0" class="J_CommentSort comment-sort-cur" onclick="HottestComment_Click()">最热</span> &nbsp;&nbsp; &nbsp;&nbsp;*@
                            <button id="btnOKUpd" type="button" class="btn btn-primary btn-sm" style="width:150px;" onclick="btnAddNewAnswer_Click()">我来回答</button>
                        </p>
                    </div>
                    <div class="comment-title" style="margin-top:5px;">
                        <p id="Questions_Name"></p>
                    </div>
                    <div id="J_ShortComment">

                    </div>
                </div>
            </div>

        </div>


        @*问题编辑*@
        <div id="divEditQuestionsRegion">
            <div class="modal-content" style="width: 100%;">

                <div class="modal-header">
                    <h3 class="modal-title" id="myModalLabel">问题编辑</h3>
                </div>
                <div class="modal-body">
                    <table id="tabEdit" style="width:100%" class="table table-bordered table-hover table td table-sm">
                        <tr style="display:none;">
                            <td>
                                <input id="txtOrderNum" name="txtOrderNum" class="form-control" style="width:50px;" />
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <textarea id="txtQuestionsContent" name="txtQuestionsContent" placeholder="问题内容" class="layui-input" style="width:100%; height:200px;"></textarea>
                            </td>
                        </tr>
                        @*<tr style="display:none;">
                                <td colspan="2">
                                    <input id="txtPdfContent" name="txtPdfContent" placeholder="pdf内容" class="layui-input" style="width:500px;" />
                                    <input id="txtPdfPageNum" name="txtPdfPageNum" placeholder="pdf页码" class="layui-input" style="width:50px;" />
                                </td>
                            </tr>*@
                        <tr>
                            <td colspan="2">
                                <button type="button" class="layui-btn layui-btn-sm layui-btn-radius layui-btn-normal" onclick="InviteOthers_Click(1)">
                                    <i class="layui-icon">&#xe613;</i>邀请其他人来回答
                                </button>
                                &nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" id="chkIsRequestReply" name="chkIsRequestReply" Text="是否要求回复">要求回复
                            </td>
                        </tr>
                        <tr>
                            <td><button id="btnCancel1" type="button" class="layui-btn layui-btn-primary" style="width:100%;" onclick="btnCancel1_Click()">取消编辑</button></td>
                            <td><button id="btnOKUpd1" type="button" class="layui-btn" style="width:100%;" onclick="QuestionsSubmit()">添加</button></td>
                        </tr>
                    </table>
                </div>

            </div>
        </div>



        @* 答案编辑 *@
        <div id="divEditAnswerRegion">

            <div class="modal-content" style="width: 100%;">
                <div class="modal-header">
                    <h4 class="modal-title" id="myModalLabel">回答编辑</h4>
                </div>
                <div class="modal-body">
                    <table id="tabEdit" style="width:100%" class="table table-bordered table-hover table td table-sm">
                        <tr>
                            <td colspan="2">
                                <textarea id="txtAnswerContent" name="txtAnswerContent" placeholder="回答内容" class="layui-input" style="width:100%; height:200px;"></textarea>
                            </td>
                        </tr>
                        <tr style="display:none;">
                            <td colspan="2">
                                <button type="button" class="layui-btn layui-btn-sm layui-btn-radius layui-btn-normal" onclick="InviteOthers_Click(2)">
                                    <i class="layui-icon">&#xe613;</i>邀请其他人来回答
                                </button>
                            </td>
                        </tr>
                        <tr>
                            <td><button id="btnCancel2" type="button" class="layui-btn layui-btn-primary" style="width:100%;" onclick="btnCancel2_Click()">取消编辑</button></td>
                            <td><button id="btnOKUpd2" type="button" class="layui-btn" style="width:100%;" onclick="AnswerSubmit()">添加</button></td>
                        </tr>
                    </table>
                </div>
                @*<div class="modal-footer">

                    </div>*@
            </div>
            <!-- /.modal-content -->
            <!-- /.modal -->

        </div>
        @*</div>*@




    </div>

    @* 标注编辑 *@
    <div class="modal fade" style="z-index:1060;" id="divEditTagsRegion" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog" style="margin-left:550px; margin-top:150px;">
            <div class="modal-content" style="width: 600px;">
                <div class="modal-header">
                    <h4 class="modal-title" id="myModalLabel">pdf标注</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                </div>
                <div class="modal-body">
                    <table id="tabEdit" style="width:100%" class="table table-bordered table-hover table td table-sm">
                        <tr style="display:none;">
                            <td colspan="2">
                                <input id="txtOrderNum" name="txtOrderNum" class="form-control" style="width:50px;" />
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <textarea id="txtTagsContent" name="txtTagsContent" placeholder="标注内容" class="layui-input" style="width:100%; height:200px;"></textarea>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <select id="ddlTagsTypeId" name="ddlTagsTypeId" class="form-control" style="width:200px;" />
                            </td>
                        </tr>
                        @*<tr style="display:none;">
                                <td>
                                    <input id="txtPdfContent2" name="txtPdfContent2" placeholder="pdf内容" class="layui-input" style="width:500px;" />
                                    <input id="txtPdfPageNum2" name="txtPdfPageNum2" placeholder="pdf页码" class="layui-input" style="width:50px;" />
                                </td>
                            </tr>*@

                        <tr>
                            <td><button id="btnCancel3" type="button" class="layui-btn layui-btn-primary" style="width:100%;" onclick="HideDialog()">取消编辑</button></td>
                            <td><button id="btnOKUpd3" type="button" class="layui-btn" style="width:100%;" onclick="TagsSubmit()">确认添加</button></td>
                        </tr>
                    </table>
                </div>
                @*<div class="modal-footer">
                        <button id="btnCancel3" type="button" class="btn btn-default" data-dismiss="modal" onclick="btnCancel3_Click()">关闭</button>
                        <button id="btnOKUpd3" type="button" class="btn btn-primary" onclick="TagsSubmit()">添加</button>
                    </div>*@
            </div>
            <!-- /.modal-content -->
        </div>
    </div>
</div>

@* 当前教学班Id *@
<input id="hidId_CurrEduCls" type="hidden" />

@* 答疑Id *@
<input id="hidqa_PaperId" type="hidden" />
@* 论文Id *@
<input id="hidPaperId" type="hidden" />

@* 推送ID *@
<input id="hidPushId" type="hidden" />

@* 主题Id *@
<input id="hidTopicId" type="hidden" />


@* 问题用户 *@
<input id="hidQuestionsUser" type="hidden" />
@* 答案排序标识 *@
<input id="hidOrderbyId" type="hidden" />

<input id="hidOpType" type="hidden" />

<input id="hidQuestionsId" type="hidden" />

<input id="hidAnswerId" type="hidden" />


@* pdf页码 *@
<input id="hidPdfPageNum" type="hidden" />

@* pdf内容 *@
<input id="hidPdfContent" type="hidden" />

@* 答案父节点Id *@
<input id="hidParentId" type="hidden" />

@* 邀请key *@
<input id="hidInviteKey" type="hidden" />


@* pdfContent num *@
<input id="hidleftNum" type="hidden" value="55" />
@* rightContent num *@
<input id="hidrightNum" type="hidden" value="45" />

@* at用户Id数量 *@
<input id="hidUserIdLst" type="hidden" />



@* 标注ID *@
<input id="hidTagsId" type="hidden" />

@* pdf当前页top *@
<input type="hidden" id="page_top" name="page_top" />

@* pdf当前页内码 *@
<input type="hidden" id="page_cache" name="page_cache" />

@* pdf——zoom *@
<input type="hidden" id="pdf_zoom" name="pdf_zoom" />

@* pdf选中文本top *@
<input type="hidden" id="pdfDiv_top" name="pdfDiv_top" />

@* pdf选中文本left *@
<input type="hidden" id="pdfDiv_left" name="pdfDiv_left" />

@* pdf选中文本left *@
<input type="hidden" id="hidPdfFile" name="hidPdfFile" />
