
@page
@{
    Layout = "~/Pages/Shared/_Layout_PC.cshtml";
    ViewData["Title"] = "社会关系表维护";

}
@section Styles{
    <link rel="stylesheet" href="../lib/bootstrap/dist/css/bootstrap.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="shortcut icon" href="~/images/favicon.ico" type="image/x-icon" />

    <link rel="stylesheet" href="~/lib/Xadmin/css/font.css">
    <link rel="stylesheet" href="~/lib/Xadmin/css/xadmin.css">
    <link rel="stylesheet" href="~/css/comment.css">
    <link rel="stylesheet" href="~/css/paperlist.css" />
    <link rel="stylesheet" href="~/css/public.css" />
    <link rel="stylesheet" type="text/css" href="../css/SimpleTree.css">
}
@section Scripts{
    <script src="~/lib/Xadmin/lib/layui/layui.js" charset="utf-8"></script>
    <script type="text/javascript" src="~/lib/Xadmin/js/xadmin.js"></script>
    <script src="../lib/jquery/dist/jquery.js"></script>
    <script src="../lib/bootstrap/dist/js/bootstrap.js"></script>

    <script src="../lib/require/require.js" data-main="../js/src/config"></script>

}
<script>
    //个人
    function liViewpointClick() {
        var strViewType = "01";
        $("#hidViewType").val(strViewType);
        require(["../js/GraduateEduTopic/SysSocialRelationsCRUDEx.js"], function (viewpoint) {
            var objPage = new viewpoint.SysSocialRelationsCRUDEx();
            objPage.BindGv_vSysSocialRelations();
        });
    }
    //他人
    function liOtherViewpointClick() {
        var strViewType = "02";
        $("#hidViewType").val(strViewType);
        require(["../js/GraduateEduTopic/SysSocialRelationsCRUDEx.js"], function (viewpoint) {
            var objPage = new viewpoint.SysSocialRelationsCRUDEx();
            objPage.BindGv_vSysSocialRelations();
        });
    }
</script>
<script>

@*var strUrl_Session_SetString = "@Model.Url_Session_SetString";
var strUrl_Session_GetString = "@Model.Url_Session_GetString";
var strCurrPrjId = "@Model.CurrPrjId";*@

 /*
  动态添加编辑区域
 (AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_AddDPV_Edit)
 */
function AddDPV_Edit(divName4Edit) {
   require(["../js/GraduateEduTopic/SysSocialRelationsCRUDEx.js"], function(syssocialrelations) {
syssocialrelations.SysSocialRelationsCRUDEx.AddDPV_Edit(divName4Edit);
});
}

 /*
  按钮单击,用于调用Js函数中btn_Click
 (AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_btn_Click)
 */
function btn_Click(strCommandName, strKeyId) {
   require(["../js/GraduateEduTopic/SysSocialRelationsCRUDEx.js"], function(syssocialrelations) {
syssocialrelations.SysSocialRelationsCRUDEx.btn_Click(strCommandName, strKeyId);
});
}

 /*
  添加新记录
 (AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_btnAddNewRecord_Click)
 */
function btnAddNewRecord_Click() {
   require(["../js/GraduateEduTopic/SysSocialRelationsCRUDEx.js"], function(syssocialrelations) {
//ShowDialog('Add');
var objPage = new syssocialrelations.SysSocialRelationsCRUDEx();
objPage.btnAddNewRecord_Click();
});
}

 /*
  删除记录的事件函数
 (AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_btnDelRecord_Click)
 */
function btnDelRecord_Click() {
   require(["../js/GraduateEduTopic/SysSocialRelationsCRUDEx.js", "../js/TS/PubFun/clsCommonFunc4Web.js"], function(syssocialrelations, commonfunc) {
var arrKeyIds = commonfunc.clsCommonFunc4Web.GetCheckedKeyIds();
if (arrKeyIds.length == 0)
{
alert("请选择需要删除的记录！");
return;
}
var objPage = new syssocialrelations.SysSocialRelationsCRUDEx();
objPage.btnDelRecord_Click();
});
}


 /*
  在数据表里删除记录的事件函数
 (AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_btnDelRecordInTab_Click)
 */
function btnDelRecordInTab_Click(strKeyId) {
   require(["../js/GraduateEduTopic/SysSocialRelationsCRUDEx.js"], function(syssocialrelations) {
if (strKeyId == "")
{
alert("请选择需要删除的记录！");
return;
}
var objPage = new syssocialrelations.SysSocialRelationsCRUDEx();
objPage.btnDelRecordInTab_Click(strKeyId);
});
}



 /*
  在数据表里修改记录
 (AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_btnUpdateRecordInTab_Click)
 */
function btnUpdateRecordInTab_Click(strKeyId) {
   require(["../js/GraduateEduTopic/SysSocialRelationsCRUDEx.js"], function(syssocialrelations) {
    if (strKeyId == "")
{
alert("请选择需要修改的记录！");
return;
}
var objPage = new syssocialrelations.SysSocialRelationsCRUDEx();
  objPage.btnUpdateRecordInTab_Click(strKeyId);
});
}


 /*
  单击数据列表中每行首列的复选框所引发的事件
 (AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_ChkClick)
 */
function ChkClick(myThis)
{
require(["../js/GraduateEduTopic/SysSocialRelationsCRUDEx.js", "../js/TS/PubFun/clsCommonFunc4Web.js"], function(syssocialrelations, commonfunc) {
var strId = myThis.id;
var strKey = strId.substring(3);
var arrKeys = commonfunc.arrSelectedKeys;
if (myThis.checked == true) {
if (arrKeys.indexOf(strKey) < 0)
{
arrKeys.push(strKey);
}
}
else {
var index = arrKeys.indexOf(strKey);
if (index > -1)
{
arrKeys.splice(index, 1);
}
}
var sstrKey = "";
for (let strK of arrKeys)
{
sstrKey += `${ strK},`;
}
$('#spanResult').html(sstrKey);
});
}

 /*
  修改记录
 (AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_ExpandDiv)
 */
         function ExpandDiv(divName) {
//基于RequireJS来调用tzPubFun.ts中的函数OnlyShowDiv。
require(["../js/TS/PubFun/tzPubFun"], function (pubfun) {
      pubfun.OnlyShowDiv(divName, "function", "content");
});
}

 /*
  获取数据列表中的所选记录
 (AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_GetAllCkechedKeys)
 */
function GetAllCkechedKeys(tabName)
{
var arrKeys = tabName.getElementsByTagName('chkInTab');
alert(arrKeys.length.toString());
}

 /*
  修改记录
 (AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_IndexPage)
 */
function IndexPage(intPageIndex)
{
console.log("跳转到" + intPageIndex + "页");
require(["../js/GraduateEduTopic/SysSocialRelationsCRUDEx.js"], function(syssocialrelations) {
var objPage = new syssocialrelations.SysSocialRelationsCRUDEx();
objPage.IndexPage(intPageIndex);
});
}

 /*
  修改记录
 (AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_JumpToPage)
 */
function JumpToPage()
{
var intCurrPageIndex = $('#input_number').val();
var intPageIndex = Number(intCurrPageIndex);
console.log("跳转到" + intPageIndex + "页");
require(["../js/GraduateEduTopic/SysSocialRelationsCRUDEx.js"], function(syssocialrelations) {
var objPage = new syssocialrelations.SysSocialRelationsCRUDEx();
objPage.IndexPage(intPageIndex);
});
}

 /*
  提交编辑
 (AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_mySubmit)
 */
function mySubmit(pstrOp) {

    //先验证控件
    if ($("#txtFullName").val() == "") {
        layer.msg('姓名不能为空!', {
            icon: 3,
            time: 1000
        });
    }
    else if ($("#txtFullName").val().length > 100) {
        layer.msg('姓名不能超过100!', {
            icon: 3,
            time: 1000
        });
    }
    else if ($("#ddlOperationTypeId").val() == "" || $("#ddlOperationTypeId").val() == "0") {
        layer.msg('操作类型不能为空!', {
            icon: 3,
            time: 1000
        });
    }
    else if ($("#ddlShareId").val() == "" || $("#ddlShareId").val() == "0") {
        layer.msg('分享不能为空!', {
            icon: 3,
            time: 1000
        });
    }
    else if ($("#txtNationality").val() == "") {
        layer.msg('国籍不能为空!', {
            icon: 3,
            time: 1000
        });
    }
    else if ($("#txtNationality").val().length > 1000) {
        layer.msg('国籍不能超过100!', {
            icon: 3,
            time: 1000
        });
    }
    else if ($("#txtAchievement").val() == "") {
        layer.msg('成就不能为空!', {
            icon: 3,
            time: 1000
        });
    }
    else if ($("#txtAchievement").val().length > 1000) {
        layer.msg('成就不能超过1000!', {
            icon: 3,
            time: 1000
        });
    }

    else {
        $("#divLoading").show();
        //防止重复提交
        $('#btnOKUpd').attr("disabled", true);
        ////调用附件验证；
        //IsFile();
        //    alert("提交" + strOp);
        require(["../js/GraduateEduTopic/SysSocialRelationsCRUDEx.js"], function (syssocialrelations) {
            var objPage = new syssocialrelations.SysSocialRelationsCRUDEx();
            objPage.btnOKUpd_Click();
        });

    }



}

 /*
  修改记录
 (AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_NextPage)
 */
function NextPage()
{
var intCurrPageIndex = $('#hidCurrPageIndex').val();
var intPageIndex = Number(intCurrPageIndex) + 1;
console.log("跳转到" + intPageIndex + "页");
require(["../js/GraduateEduTopic/SysSocialRelationsCRUDEx.js"], function(syssocialrelations) {
var objPage = new syssocialrelations.SysSocialRelationsCRUDEx();
objPage.IndexPage(intPageIndex);
});
}

 /*
  页面导入-在导入页面后运行的函数
 (AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_Page_Load)
 */
window.onload = function() {
   require(["../js/GraduateEduTopic/SysSocialRelationsCRUDEx.js"], function(syssocialrelations) {
var objPage = new syssocialrelations.SysSocialRelationsCRUDEx();
objPage.Page_Load();
});
}

 /*
  修改记录
 (AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_PageNum)
 */
function PageNum(intPageIndex)
{
console.log("跳转到" + intPageIndex + "页");
require(["../js/GraduateEduTopic/SysSocialRelationsCRUDEx.js"], function(syssocialrelations) {
var objPage = new syssocialrelations.SysSocialRelationsCRUDEx();
objPage.IndexPage(intPageIndex);
});
}

 /*
  修改记录
 (AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_PrevPage)
 */
function PrevPage()
{
var intCurrPageIndex = $('#hidCurrPageIndex').val();
var intPageIndex = Number(intCurrPageIndex) - 1;
console.log("跳转到" + intPageIndex + "页");
require(["../js/GraduateEduTopic/SysSocialRelationsCRUDEx.js"], function(syssocialrelations) {
var objPage = new syssocialrelations.SysSocialRelationsCRUDEx();
objPage.IndexPage(intPageIndex);
});
}

 /*
  全选数据列表中的所有记录
 (AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_SetAllCkechedKeys)
 */
function SetAllCkechedKeys(tabName)
{
var thisChk = event.target;
require(["../js/TS/PubFun/clsCommonFunc4Web.js"], function (commonfunc) {
console.log(tabName);
console.log(thisChk);
commonfunc.clsCommonFunc4Web.SetAllCkechedKeys(tabName, thisChk);
});
}

 /*
  修改记录
 (AutoGCLib.WA_ViewScript_TS4Html:Gen_WApi_JS_SortBy)
 */
function SortBy(strFldName)
{
console.log("按：" + strFldName + "排序");
require(["../js/GraduateEduTopic/SysSocialRelationsCRUDEx.js"], function(syssocialrelations) {
var objPage = new syssocialrelations.SysSocialRelationsCRUDEx();
objPage.SortBy(strFldName);
});
}


//技能数据提交
function btnIsSubmit_Click(strKeyId) {
    require(["../js/GraduateEduTopic/SysSocialRelationsCRUDEx.js", "../js/TS/PubFun/clsCommonFunc4Web.js"], function (viewpoint, commonfunc) {

        if (strKeyId == "") {
            alert("请选择需要提交的记录！");
            return;
        }
        //ShowDialog('Update');
        var objPage = new viewpoint.SysSocialRelationsCRUDEx();
        objPage.btnIsSubmit_Click(strKeyId);
    });
}
//取消提交
function btnCancelSubmit_Click(strKeyId) {

    require(["../js/GraduateEduTopic/SysSocialRelationsCRUDEx.js", "../js/TS/PubFun/clsCommonFunc4Web.js"], function (viewpoint, commonfunc) {

        if (strKeyId == "") {
            alert("请选择需要取消的记录！");
            return;
        }
        var objPage = new viewpoint.SysSocialRelationsCRUDEx();
        objPage.btnCancelSubmit_Click(strKeyId);

    });

}
</script>


<div id="divLoading" class="loading">
    <img src="~/images/CirclePoint.gif" />
</div>
<div id="tabLayout" class="tab_layout">
    @*-- 标题层 --*@

    @*<div style="position: relative; width: 648px; height: 37px; left: 0px; top: 0px;">
            <Label id="lblViewTitle" name="lblViewTitle" class="h5">
                社会关系表CRUD
            </Label>
            <Label id="lblMsg_List" name="lblMsg_List" class="text-warning" style="width:250px;">
            </Label>
        </div>*@

    <div class="x-nav">
        <span class="layui-breadcrumb">
            <a href="">首页</a>
            <a href="">主题研究管理</a>
            <a>
                <cite>社会关系</cite>
            </a>
            <Label id="lblMsg_List" name="lblMsg_List"></Label>
        </span>
        <a class="layui-btn layui-btn-small" style="line-height:1.6em;margin-top:3px;float:right" onclick="location.reload()" title="刷新">
            <i class="layui-icon layui-icon-refresh" style="line-height:30px"></i>
        </a>
    </div>
    @*-- 查询层 --*@

    <div id="divQuery" class="div_query">
        <table id="tabQuery" style="width:50%;" class="table table-bordered table-hover table td table-sm">
            <tr>
                @*<td>
                        <Label id="lblFullName_q" name="lblFullName_q" class="col-form-label text-right" style="width:90px;">
                            姓名
                        </Label>
                    </td>*@
                <td>
                    <input id="txtFullName_q" name="txtFullName_q" placeholder="姓名" class="layui-input" style="width:220px;" />
                </td>
                @*<td>
                        <Label id="lblAchievement_q" name="lblAchievement_q" class="col-form-label text-right" style="width:90px;">
                            成就
                        </Label>
                    </td>*@
                <td>
                    <input id="txtAchievement_q" name="txtAchievement_q" placeholder="成就" class="layui-input" style="width:220px;" />
                </td>
                @*<td>
                        <Label id="lblLevelId_q" name="lblLevelId_q" class="col-form-label text-right" style="width:90px;">
                            级别Id
                        </Label>
                    </td>*@
                <td>
                    <select id="ddlLevelId_q" name="ddlLevelId_q" class="form-control" style="width:180px;"></select>
                </td>
                <td>
                    @*<button type="submit" id="btnQuery" name="btnQuery" class="btn btn-outline-warning text-nowrap" onclick="btn_Click('Query')">查询</button>*@
                    <button class="layui-btn" lay-submit="" lay-filter="sreach" onclick="btn_Click('Query')">
                        <i class="layui-icon">&#xe615;</i>
                    </button>
                </td>
                @*<td>
                        <button type="submit" id="btnExportExcel" name="btnExportExcel" class="btn btn-outline-warning text-nowrap" onclick="btn_Click('ExportExcel')">导出Excel</button>
                    </td>*@
            </tr>
        </table>
    </div>
    @*-- 功能区 --*@

    @*<div id="divFunction" class="table table-bordered table-hover">
            <ul class="nav">
                <li class="nav-item">
                    <Label id="lblSysSocialRelationsList" name="lblSysSocialRelationsList" class="col-form-label text-info" style="width:250px;">

                    </Label>
                </li>
                <li class="nav-item ml-3">

                    <button id="btnAddNewRecord" name="btnAddNewRecord" class="btn btn-outline-info btn-sm text-nowrap" onclick="btn_Click('Create')">添加</button>
                </li>
                <li class="nav-item ml-3">
                    <button id="btnUpdateRecord" name="btnUpdateRecord" class="btn btn-outline-info btn-sm text-nowrap" onclick="btn_Click('Update')">修改</button>
                </li>
                <li class="nav-item ml-3">
                    <button id="btnDelRecord" name="btnDelRecord" class="btn btn-outline-info btn-sm text-nowrap" onclick="btn_Click('Delete')">删除</button>
                </li>
                <li class="nav-item ml-3">
                    <button id="btnIsSubmit" name="btnIsSubmit" class="btn btn-outline-info text-nowrap btn-sm" onclick="btnIsSubmit_Click()">数据提交</button>
                </li>
                <li class="nav-item ml-3">
                    <button id="btnCancelSubmit" style="display:none;" name="btnCancelSubmit" class="btn btn-outline-info text-nowrap btn-sm" onclick="btnCancelSubmit_Click()">取消提交</button>
                </li>
            </ul>
        </div>*@
    <div id="FunInfo" class="alert alert-info">
        <strong>本界面功能：</strong> 在本界面可以维护社会关系,维护好了就能提交，提交以后别人可以在主题维护界面进行引用并评价，添加和修改记录可以产生历史版本便于查看历史记录。
    </div>
    @*-- 列表层 --*@
    <div id="divList" class="div_List">
        <ul class="nav nav-pills" role="tablist">
            <li class="nav-item">
                <a class="nav-link active" data-toggle="pill" href="#TabviewPoint" onclick="liViewpointClick()">社会关系</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="pill" href="#TabOtherviewPoint" onclick="liOtherViewpointClick()">他人社会关系</a>
            </li>
        </ul>
        <div class="tab-content">
            <div id="TabviewPoint" class="tab-pane active">
                <div id="divDataLst" class="div_List">
                </div>
            </div>
            <div id="TabOtherviewPoint" class="tab-pane fade">
                <div id="divOtherDataLst" class="div_List">
                </div>
            </div>

            <div id="divPager1" class="paperviewpoint" value="1" style="display:none;">
               
            </div>

        </div>
    </div>
    @*-- 编辑层 --*@
    <div id="divEdit" value="1"></div>
</div>
<input id="hidOpType" type="hidden" />
<input id="hidKeyId" type="hidden" />
<input id="hidUserId" type="hidden" />
<input id="hidCurrPageIndex" type="hidden" value="1" />
<input id="hidSortvSysSocialRelationsBy" type="hidden" value="" />
<!-- 页面类型区分个人和他人  -->
<input id="hidViewType" type="hidden" />
<!-- 社会关系Id  -->
<input id="hidSocialId" type="hidden" />