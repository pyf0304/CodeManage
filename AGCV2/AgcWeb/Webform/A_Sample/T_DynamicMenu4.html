<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <script src="../../Scripts/jquery-3.6.0.min.js"></script>
    <script src="../../Scripts/bootstrap.min.js"></script>
    <script src="../../Scripts/boostrap-contextmenu/bootstrap-contextmenu.js"></script>
    <script src="../../Scripts/boostrap-contextmenu/prettify.js"></script>

    <!-- Le styles -->
    <link href="http://cdnjs.cloudflare.com/ajax/libs/prettify/r224/prettify.css" type="text/css">
    <style>

        body {
            padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
        }
    </style>
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
    <script>
        function GetArray(arr) {
            var arrLst = new Array();
            for (var i = 0; i < arr.length; i++) {
                var chk = arr[i];// as HTMLElement;
                arrLst.push(chk);
            }
            return arrLst;
        }
        function showMsg(context, e) {
            e = e || event;
            var tag = e.target || e.srcElement;
            alert(tag.innerHTML);

            console.log(context);
            console.log(e);

            //    alert($(e.target).text());
//            alert("showMsg()");
        }
        function SetContentMenu() {
            var mySpan = document.getElementById("mySpan");
            mySpan.setAttribute("data-toggle", "context");
            mySpan.setAttribute("data-target", "#context-menu");
            var context_menu = document.getElementById("context-menu");
            var arrChild = context_menu.childNodes;
            var arrChild2 = GetArray(arrChild);
            var myUl = arrChild2.find(x => x.className == "dropdown-menu");
            console.log(myUl);
            var myLi = document.createElement("li");
            var myA = document.createElement("a");
            //myA.href = "http://www.shnu.edu.cn";
            myA.setAttribute("onclick", "showMsg()");
            myA.innerText = "myA";
            myLi.appendChild(myA);
            myUl.appendChild(myLi);
        }
    </script>
</head>
<body>
    <h1>Demo</h1>
    <p>Right click inside the box to trigger the menu</p>
    <h5>Demo 1</h5>
    <p>Using <code>data-toggle="context"</code> to attach a context-menu</p>
    <!-- Element div that needs a custom context menu -->
    <span id="mySpan" style="height:100px;width:150px;border:1px solid #ddd">
        mySpan mySpan mySpan mySpan
    </span><input id="btnSetContentMenu" type="button" onclick="SetContentMenu()" value="设置右击菜单" />
    <div id="context" data-toggle="context" data-target="#context-menu" style="height:300px;width:650px;border:1px solid #ddd">
    </div>
    <!-- Your custom menu with dropdown-menu as default styling -->
    <div id="context-menu">
        <ul class="dropdown-menu" role="menu">
            <li><a tabindex="-1">Action</a></li>
            <li><a tabindex="-1">Another action</a></li>
            <li><a tabindex="-1">Something else here</a></li>
            <li class="divider"></li>
            <li><a tabindex="-1">Separated link</a></li>
        </ul>
    </div>

    <hr>
    <h5>Demo 2</h5>
    <div id="main" data-toggle="context">This is an area where the context menu is active <span style="background-color: #cecece">However, we wont allow it here.</span> But anywhere else in this text should be perfectly fine. This one is started with only javascript</div>
    <div id="myDiv" data-toggle="context">mySpan mySpan mySpan mySpan</div>
    <div id="context-menu2">
        <ul class="dropdown-menu" role="menu">
            <li><a tabindex="-1">Action</a></li>
            <li><a tabindex="-1">Another action</a></li>
            <li><a tabindex="-1">Something else here</a></li>
            <li class="divider"></li>
            <li><a tabindex="-1">Separated link</a></li>
        </ul>
    </div>
    <hr />
    <h5>Demo 3</h5>
    <p>Show the menu name of the item that was selected</p>
    <!-- Element div that needs a custom context menu -->
    <div id="context2" data-toggle="context" style="height:300px;width:650px;border:1px solid #ddd">
    </div>

    <script type="text/javascript">
        document.oncontextmenu = function (e) {
            e = e || event;
            
            var tag = e.target || e.srcElement;
            console.log(tag.id);
            //alert(tag.innerHTML);
            //return false;
        }
        // Demo 2
        $('#main').contextmenu({
            target: '#context-menu2',
            before: function (e) {
                // This function is optional.
                // Here we use it to stop the event if the user clicks a span
                e.preventDefault();
                if (e.target.tagName == 'SPAN') {
                    e.preventDefault();
                    this.closemenu();
                    return false;
                }
                this.getMenu().find("li").eq(2).find('a').html("This was dynamically changed");
                return true;
            }
        });
        $('#myDiv').contextmenu({
            target: '#context-menu2',
            before: function (e) {
                // This function is optional.
                // Here we use it to stop the event if the user clicks a span
                e.preventDefault();
                if (e.target.tagName == 'SPAN') {
                    e.preventDefault();
                    this.closemenu();
                    return false;
                }
                this.getMenu().find("li").eq(2).find('a').html("This was dynamically changed");
                return true;
            }
        });
    </script>
    <script type="text/javascript">
        // Demo 3
        $('#context2').contextmenu({
            target: '#context-menu2',
            items: {
                foo: { name: "Foo", callback: function (key, opt) { alert("Foo!"); } },
                bar: { name: "Bar", callback: function (key, opt) { alert("Bar!") } }
            },
            onItem: function (context, e) {
                alert($(e.target).text());
            }
        });

        $('#context-menu2').on('show.bs.context', function (e) {
            console.log('before show event');
        });

        $('#context-menu2').on('shown.bs.context', function (e) {
            console.log('after show event');
        });

        $('#context-menu2').on('hide.bs.context', function (e) {
            console.log('before hide event');
        });

        $('#context-menu2').on('hidden.bs.context', function (e) {
            console.log('after hide event');
        });
    </script>
</body>
</html>